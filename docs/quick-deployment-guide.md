# å¿«é€Ÿéƒ¨ç½²æŒ‡å— / Quick Deployment Guide

> é’ˆå¯¹éƒ¨ç½²ä¾¿åˆ©æ€§ã€å¯†ç ç”Ÿæˆå’Œæ•°æ®åº“åˆå§‹åŒ–é—®é¢˜çš„å®Œæ•´è§£å†³æ–¹æ¡ˆ

## ğŸ¯ ä¸‰ä¸ªé—®é¢˜çš„è§£å†³æ–¹æ¡ˆ

### é—®é¢˜ 1: éƒ¨ç½²ä¸æ–¹ä¾¿
**ä¹‹å‰**: éœ€è¦æ‰‹åŠ¨å¤åˆ¶ .envï¼Œè¿è¡Œå¤šä¸ª openssl å‘½ä»¤ï¼Œæ‰‹åŠ¨ç”Ÿæˆå¯†ç å“ˆå¸Œ
**ç°åœ¨**: ä¸€ä¸ªå‘½ä»¤æå®š ğŸ‘‡

```bash
pnpm setup
```

è¿™ä¸ªäº¤äº’å¼å‘å¯¼ä¼šï¼š
- âœ… è‡ªåŠ¨ç”Ÿæˆ 64 ä½åŠ å¯†å¯†é’¥ï¼ˆENCRYPTION_KEYï¼‰
- âœ… è‡ªåŠ¨ç”Ÿæˆä¼šè¯å¯†é’¥ï¼ˆSESSION_SECRETï¼‰
- âœ… è®©æ‚¨é€‰æ‹©è‡ªå·±è¾“å…¥å¯†ç æˆ–è‡ªåŠ¨ç”Ÿæˆéšæœºå¯†ç 
- âœ… åŸºäºå¯†ç ç”Ÿæˆç®¡ç†å‘˜å¯†ç å“ˆå¸Œï¼ˆADMIN_PASSWORD_HASHï¼‰
- âœ… è‡ªåŠ¨åˆ›å»º .env æ–‡ä»¶
- âœ… æ˜¾ç¤ºé…ç½®æ‘˜è¦

### é—®é¢˜ 2: å¯†ç ç”Ÿæˆç¹ç
**ä¹‹å‰**: éœ€è¦æ‰‹åŠ¨è¿è¡Œ `openssl rand -hex 32`ã€`openssl rand -base64 32` å’Œ `node -e "require('bcryptjs').hash(...)"`

**ç°åœ¨**: `pnpm setup` å…¨éƒ¨æå®šï¼æ‚¨å¯ä»¥é€‰æ‹©ï¼š
- é€‰é¡¹ 1: è‡ªå·±è¾“å…¥å¯†ç ï¼ˆéœ€è¦è‡³å°‘ 8 ä¸ªå­—ç¬¦ï¼‰
- é€‰é¡¹ 2: è®©ç³»ç»Ÿç”Ÿæˆéšæœºå¯†ç 

### é—®é¢˜ 3: æ•°æ®åº“åˆå§‹åŒ–ä¸æ¸…æ¥š
**ä¹‹å‰**: éœ€è¦æ‰‹åŠ¨è¿è¡Œ `pnpm drizzle-kit push`ï¼Œä¸çŸ¥é“æ•°æ®åº“åœ¨å“ªé‡Œã€å¦‚ä½•åˆ›å»º

**ç°åœ¨**: 
```bash
pnpm db:migrate
```

è¿™ä¸ªå‘½ä»¤ä¼šï¼š
- âœ… è‡ªåŠ¨åˆ›å»º `data/` ç›®å½•
- âœ… åˆ›å»º `data/paste.db` SQLite æ•°æ®åº“
- âœ… è¿è¡Œæ‰€æœ‰è¿ç§»æ–‡ä»¶ï¼Œåˆå§‹åŒ–è¡¨ç»“æ„
- âœ… å¯ç”¨ WAL æ¨¡å¼ï¼ˆæé«˜æ€§èƒ½ï¼‰

**æ›´è¯¦ç»†çš„è¯´æ˜**: è¯·æŸ¥çœ‹ [æ•°æ®åº“åˆå§‹åŒ–æ–‡æ¡£](./database-initialization.md)

## ğŸš€ å®Œæ•´éƒ¨ç½²æµç¨‹ï¼ˆ3 åˆ†é’Ÿæå®šï¼‰

### æœ¬åœ°å¼€å‘éƒ¨ç½²

```bash
# 1. å…‹éš†é¡¹ç›®
git clone https://github.com/dnslin/paste.git
cd paste

# 2. å®‰è£…ä¾èµ–
pnpm install

# 3. è¿è¡Œè®¾ç½®å‘å¯¼ï¼ˆç”Ÿæˆ .envï¼‰
pnpm setup
# è¾“å…¥ç®¡ç†å‘˜å¯†ç ï¼Œä¾‹å¦‚: admin123456

# 4. åˆå§‹åŒ–æ•°æ®åº“
pnpm db:migrate

# 5. å¯åŠ¨æœåŠ¡
pnpm dev
```

âœ… å®Œæˆï¼è®¿é—® http://localhost:3000

### Docker éƒ¨ç½²ï¼ˆæœ€ç®€å•ï¼‰

```bash
# 1. å…‹éš†é¡¹ç›®
git clone https://github.com/dnslin/paste.git
cd paste

# 2. ç”Ÿæˆç¯å¢ƒå˜é‡
pnpm install
pnpm setup

# 3. å¯åŠ¨ Docker å®¹å™¨ï¼ˆè‡ªåŠ¨åˆå§‹åŒ–æ•°æ®åº“ï¼‰
docker-compose up -d
```

âœ… å®Œæˆï¼è®¿é—® http://localhost:3000

**æ³¨æ„**: Docker å®¹å™¨å¯åŠ¨æ—¶ä¼šè‡ªåŠ¨è¿è¡Œæ•°æ®åº“è¿ç§»ï¼Œæ— éœ€æ‰‹åŠ¨åˆå§‹åŒ–ï¼

### ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²

è¯¦ç»†æ­¥éª¤è¯·å‚è€ƒ [å®Œæ•´éƒ¨ç½²æŒ‡å—](./deployment.md)

## ğŸ“š æ–°å¢çš„å‘½ä»¤

| å‘½ä»¤ | è¯´æ˜ |
|-----|------|
| `pnpm setup` | äº¤äº’å¼è®¾ç½®å‘å¯¼ï¼Œç”Ÿæˆ .env é…ç½® |
| `pnpm db:migrate` | è¿è¡Œæ•°æ®åº“è¿ç§»ï¼Œåˆå§‹åŒ–æ•°æ®åº“ |
| `pnpm db:generate` | ç”Ÿæˆæ–°çš„è¿ç§»æ–‡ä»¶ï¼ˆä¿®æ”¹ schema åï¼‰ |
| `pnpm db:studio` | æ‰“å¼€ Drizzle Studio æ•°æ®åº“ç®¡ç†ç•Œé¢ |

## ğŸ¨ æ–°å¢çš„è„šæœ¬

| è„šæœ¬ | ä½ç½® | è¯´æ˜ |
|-----|-----|------|
| è®¾ç½®å‘å¯¼ | `scripts/setup.js` | è‡ªåŠ¨ç”Ÿæˆç¯å¢ƒå˜é‡ |
| æ•°æ®åº“è¿ç§» | `scripts/migrate.js` | è¿è¡Œæ•°æ®åº“è¿ç§» |
| Docker å…¥å£ç‚¹ | `scripts/docker-entrypoint.sh` | Docker å®¹å™¨å¯åŠ¨è„šæœ¬ |

è¯¦ç»†è¯´æ˜è¯·æŸ¥çœ‹ [scripts/README.md](../scripts/README.md)

## ğŸ“– æ–°å¢çš„æ–‡æ¡£

| æ–‡æ¡£ | è¯´æ˜ |
|-----|------|
| [deployment.md](./deployment.md) | å®Œæ•´çš„éƒ¨ç½²æŒ‡å—ï¼ˆæœ¬åœ°ã€Dockerã€ç”Ÿäº§ç¯å¢ƒï¼‰ |
| [database-initialization.md](./database-initialization.md) | æ•°æ®åº“åˆå§‹åŒ–è¯¦ç»†è¯´æ˜ |
| [scripts/README.md](../scripts/README.md) | è„šæœ¬ä½¿ç”¨è¯´æ˜ |

## ğŸ”’ å®‰å…¨è¯´æ˜

- âœ… æ‰€æœ‰å¯†é’¥éƒ½æ˜¯è‡ªåŠ¨ç”Ÿæˆçš„ï¼ŒåŠ å¯†å¼ºåº¦é«˜
- âœ… ç®¡ç†å‘˜å¯†ç ä½¿ç”¨ bcrypt å“ˆå¸Œï¼ˆcost=10ï¼‰
- âœ… åŠ å¯†å¯†é’¥æ˜¯ 32 å­—èŠ‚ï¼ˆ256 ä½ï¼‰AES å¯†é’¥
- âœ… .env æ–‡ä»¶å·²åœ¨ .gitignore ä¸­æ’é™¤ï¼Œä¸ä¼šè¢«æäº¤åˆ°ä»“åº“

## ğŸ’¡ å¸¸è§é—®é¢˜

### Q1: æˆ‘å·²ç»æœ‰ .env æ–‡ä»¶äº†ï¼Œè¿è¡Œ `pnpm setup` ä¼šè¦†ç›–å—ï¼Ÿ

**A**: ä¼šæç¤ºæ‚¨æ˜¯å¦è¦†ç›–ã€‚å¦‚æœé€‰æ‹© "N"ï¼ˆæˆ–ç›´æ¥å›è½¦ï¼‰ï¼Œåˆ™ä¸ä¼šè¦†ç›–ã€‚

### Q2: å¿˜è®°ç®¡ç†å‘˜å¯†ç æ€ä¹ˆåŠï¼Ÿ

**A**: é‡æ–°è¿è¡Œ `pnpm setup`ï¼Œé€‰æ‹©è¦†ç›– .env æ–‡ä»¶ï¼Œè¾“å…¥æ–°å¯†ç å³å¯ã€‚

### Q3: æ•°æ®åº“æ–‡ä»¶ä¼šè¢«æäº¤åˆ° Git ä»“åº“å—ï¼Ÿ

**A**: ä¸ä¼šã€‚`data/` ç›®å½•å’Œæ‰€æœ‰ `.db` æ–‡ä»¶éƒ½å·²åœ¨ .gitignore ä¸­æ’é™¤ã€‚

### Q4: Docker éƒ¨ç½²æ—¶éœ€è¦æ‰‹åŠ¨åˆå§‹åŒ–æ•°æ®åº“å—ï¼Ÿ

**A**: ä¸éœ€è¦ã€‚Docker å®¹å™¨å¯åŠ¨æ—¶ä¼šè‡ªåŠ¨è¿è¡Œæ•°æ®åº“è¿ç§»ã€‚

### Q5: æ•°æ®åº“æ–‡ä»¶åœ¨å“ªé‡Œï¼Ÿ

**A**: åœ¨é¡¹ç›®æ ¹ç›®å½•çš„ `data/paste.db`ã€‚è¿™ä¸ªç›®å½•ä¼šè‡ªåŠ¨åˆ›å»ºã€‚

### Q6: å¦‚ä½•æŸ¥çœ‹æ•°æ®åº“å†…å®¹ï¼Ÿ

**A**: è¿è¡Œ `pnpm db:studio`ï¼Œä¼šæ‰“å¼€ä¸€ä¸ªå¯è§†åŒ–çš„æ•°æ®åº“ç®¡ç†ç•Œé¢ã€‚

### Q7: å¦‚ä½•å¤‡ä»½æ•°æ®åº“ï¼Ÿ

**A**: å¤åˆ¶æ•´ä¸ª `data/` ç›®å½•å³å¯ï¼š
```bash
cp -r data/ backup_$(date +%Y%m%d)/
```

## ğŸ‰ æ€»ç»“

é€šè¿‡è¿™æ¬¡æ”¹è¿›ï¼Œéƒ¨ç½² Paste æœåŠ¡å˜å¾—éå¸¸ç®€å•ï¼š

**ä¹‹å‰**: 7 ä¸ªæ‰‹åŠ¨æ­¥éª¤ï¼Œ å®¹æ˜“å‡ºé”™
```bash
1. cp .env.example .env
2. openssl rand -hex 32  # æ‰‹åŠ¨å¤åˆ¶åˆ° .env
3. openssl rand -base64 32  # æ‰‹åŠ¨å¤åˆ¶åˆ° .env
4. node -e "require('bcryptjs').hash('password', 10).then(console.log)"  # æ‰‹åŠ¨å¤åˆ¶
5. ç¼–è¾‘ .env å¡«å…¥ä¸Šé¢çš„å€¼
6. pnpm drizzle-kit push
7. pnpm dev
```

**ç°åœ¨**: 3 ä¸ªå‘½ä»¤ï¼Œå…¨è‡ªåŠ¨
```bash
1. pnpm setup      # è‡ªåŠ¨ç”Ÿæˆæ‰€æœ‰é…ç½®
2. pnpm db:migrate  # è‡ªåŠ¨åˆå§‹åŒ–æ•°æ®åº“
3. pnpm dev        # å¯åŠ¨æœåŠ¡
```

èŠ‚çœ 70% çš„éƒ¨ç½²æ—¶é—´ï¼ğŸš€

## ğŸ“ éœ€è¦å¸®åŠ©ï¼Ÿ

- ğŸ“– æŸ¥çœ‹ [å®Œæ•´éƒ¨ç½²æŒ‡å—](./deployment.md)
- ğŸ“– æŸ¥çœ‹ [æ•°æ®åº“åˆå§‹åŒ–æ–‡æ¡£](./database-initialization.md)
- ğŸ› [æŠ¥å‘Šé—®é¢˜](https://github.com/dnslin/paste/issues)
- ğŸ’¬ [è®¨è®ºåŒº](https://github.com/dnslin/paste/discussions)
